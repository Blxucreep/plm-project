<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des fournisseurs</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'style_supplier.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    {% include 'navbar.html' %}

    <header class="page-header">
        <h1>Gestion des fournisseurs</h1>
        <p>Ajoutez, modifiez et consultez vos fournisseurs facilement.</p>
    </header>

    <main class="container">
        <!-- Formulaire Gestion des Fournisseurs -->
        <section class="form-section">
            <h2>Ajouter / Modifier un fournisseur</h2>
            <form method="post" id="supplierForm">
                {% csrf_token %}
                <input type="hidden" name="supplier_id" id="supplierId">
                <div class="form-group">
                    <label for="name">Nom :</label>
                    <input type="text" name="name" id="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email :</label>
                    <input type="email" name="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Téléphone :</label>
                    <input type="text" name="phone" id="phone" required>
                </div>
                <div class="form-group">
                    <label for="address">Adresse :</label>
                    <textarea name="address" id="address" rows="2" required></textarea>
                </div>
                <div class="form-group">
                    <label for="products_sold">Produits vendus :</label>
                    <textarea name="products_sold" id="productsSold" rows="2" required></textarea>
                </div>
                <button type="submit" class="btn-primary">Enregistrer</button>
            </form>
        </section>

        <!-- Tableau des fournisseurs -->
        <section class="table-section">
            <h2>Liste des fournisseurs</h2>
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Email</th>
                        <th>Téléphone</th>
                        <th>Adresse</th>
                        <th>Produits vendus</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for supplier in suppliers %}
                    <tr>
                        <td>{{ supplier.name }}</td>
                        <td>{{ supplier.email }}</td>
                        <td>{{ supplier.phone }}</td>
                        <td>{{ supplier.address }}</td>
                        <td>{{ supplier.products_sold }}</td>
                        <td>
                            <button class="btn-secondary" onclick="editSupplier({{ supplier.id }}, '{{ supplier.name|escapejs }}', '{{ supplier.email|escapejs }}', '{{ supplier.phone|escapejs }}', '{{ supplier.address|escapejs }}', '{{ supplier.products_sold|escapejs }}')">Modifier</button>
                            <form method="post" action="{% url 'supplier_delete' supplier.id %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn-danger">Supprimer</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
        <!-- Modification des scores -->
        <section class="performance-buttons">           
            <h3>Modifier les performances</h3>
            <table>
                <thead>
                    <tr>
                        <th>Fournisseur</th>
                        <th>Score actuel</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for supplier in suppliers %}
                    <tr>
                        <td>{{ supplier.name }}</td>
                        <td id="score-{{ supplier.id }}">{{ supplier.performance_score }}</td>
                        <td>
                            <button onclick="updateScore({{ supplier.id }}, 'increase')">Augmenter</button>
                            <button onclick="updateScore({{ supplier.id }}, 'decrease')">Diminuer</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
    </main>
    {% include 'footer.html' %}

    
    
    
</body>
</html>
